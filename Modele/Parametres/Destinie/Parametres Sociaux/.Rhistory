graph_compar <- function (serie,t1,t2,titre)
{
plot   (seq(1900+t1,1900+t2,by=1),serie[1,t1:t2],xlab="Annee", ylab=titre,
ylim=c(min(serie[,t1:t2],na.rm=TRUE),max(serie[,t1:t2],na.rm=TRUE)),lwd=2,col="grey0",type="l")
points (seq(1900+t1,1900+t2,by=1),serie[2,t1:t2],lwd=2,col="grey20",type="l")
points (seq(1900+t1,1900+t2,by=1),serie[3,t1:t2],lwd=2,col="grey40",type="l")
}
par(mar=c(6.1, 3.1, 4.1, 2.1))
par(xpd=TRUE)
bp <- graph_compar(RATIOPENS   ,110,159,"Ratio pension/PIB")
box()
title("Graphe 7 : \nMasse des avantages contributifs (2020, en Mds)")
legend.text <- c("Scenario B","Scenario A","Scenario C")
legend(mean(range(bp)), -0.5, legend.text,cex=0.9, xjust = 0.5,yjust=1.3,fill=c("grey0","grey40","grey80"))
graph_compar <- function (serie,t1,t2,titre)
{
plot   (seq(1900+t1,1900+t2,by=1),serie[1,t1:t2],xlab="Annee", ylab=titre,
ylim=c(min(serie[,t1:t2],na.rm=TRUE),max(serie[,t1:t2],na.rm=TRUE)),lwd=2,col="grey0",type="l")
points (seq(1900+t1,1900+t2,by=1),serie[2,t1:t2],lwd=4,col="grey40",type="l")
points (seq(1900+t1,1900+t2,by=1),serie[3,t1:t2],lwd=4,col="grey80",type="l")
}
par(mar=c(6.1, 3.1, 4.1, 2.1))
par(xpd=TRUE)
bp <- graph_compar(RATIOPENS   ,110,159,"Ratio pension/PIB")
box()
title("Graphe 7 : \nMasse des avantages contributifs (2020, en Mds)")
legend.text <- c("Scenario B","Scenario A","Scenario C")
legend(mean(range(bp)), -0.5, legend.text,cex=0.9, xjust = 0.5,yjust=1.3,fill=c("grey0","grey40","grey80"))
graph_compar <- function (serie,t1,t2,titre)
{
plot   (seq(1900+t1,1900+t2,by=1),serie[1,t1:t2],xlab="Annee", ylab=titre,
ylim=c(min(serie[,t1:t2],na.rm=TRUE),max(serie[,t1:t2],na.rm=TRUE)),lwd=4,col="grey0",type="l")
points (seq(1900+t1,1900+t2,by=1),serie[2,t1:t2],lwd=4,col="grey40",type="l")
points (seq(1900+t1,1900+t2,by=1),serie[3,t1:t2],lwd=4,col="grey80",type="l")
}
title("Graphe 2 : Evolution du ratio retraite/PIB \nVariantes de scénario de croissance")
par(mar=c(6.1, 3.1, 4.1, 2.1))
par(xpd=TRUE)
bp <- graph_compar(RATIOPENS   ,110,159,"Ratio pension/PIB")
box()
title("Graphe 2 : Evolution du ratio retraite/PIB \nVariantes de scénario de croissance")
legend.text <- c("Scenario B","Scenario A","Scenario C")
legend(mean(range(bp)), -0.5, legend.text,cex=0.9, xjust = 0.5,yjust=1.3,fill=c("grey0","grey40","grey80"))
? legend
legend(0, -0.5, legend.text,cex=0.9, xjust = 0.5,yjust=1.3,fill=c("grey0","grey40","grey80"))
legend(0, -0.5, legend.text,cex=0.9, xjust = 0.5,yjust=1,fill=c("grey0","grey40","grey80"))
legend(0, -0.5, legend.text,cex=0.9, xjust = 0.5,yjust=0,fill=c("grey0","grey40","grey80"))
par(mar=c(2.1, 3.1, 4.1, 2.1))
par(xpd=TRUE)
bp <- graph_compar(RATIOPENS   ,110,159,"Ratio pension/PIB")
box()
title("Graphe 2 : Evolution du ratio retraite/PIB \nVariantes de scénario de croissance")
legend.text <- c("Scenario B","Scenario A","Scenario C")
legend(0, -0.5, legend.text,cex=0.9, xjust = 0.5,yjust=0,fill=c("grey0","grey40","grey80"))
par(mar=c(7.1, 3.1, 4.1, 2.1))
par(xpd=TRUE)
bp <- graph_compar(RATIOPENS   ,110,159,"Ratio pension/PIB")
box()
title("Graphe 2 : Evolution du ratio retraite/PIB \nVariantes de scénario de croissance")
legend.text <- c("Scenario B","Scenario A","Scenario C")
legend(0, -0.5, legend.text,cex=0.9, xjust = 0.5,yjust=0,fill=c("grey0","grey40","grey80"))
legend(0, -0.5, legend.text,fill=c("grey0","grey40","grey80"))
par(mar=c(7.1, 3.1, 2.1, 2.1))
par(xpd=TRUE)
bp <- graph_compar(RATIOPENS   ,110,159,"Ratio pension/PIB")
box()
title("Graphe 2 : Evolution du ratio retraite/PIB \nVariantes de scénario de croissance")
legend.text <- c("Scenario B","Scenario A","Scenario C")
legend(0, -0.5, l
save.image(paste0(cheminsource,"Simulations/CN/Scenario de reference/VariantesMacro.RData"))
par(mar=c(7.1, 3.1, 4.1, 2.1))
par(xpd=TRUE)
bp <- graph_compar(RATIOPENS   ,110,159,"Ratio pension/PIB")
box()
title("Graphe 2 : Evolution du ratio retraite/PIB \nVariantes de scénario de croissance")
legend.text <- c("Scenario B","Scenario A","Scenario C")
legend(0, 0, legend.text,fill=c("grey0","grey40","grey80"))
par(mar=c(7.1, 3.1, 4.1, 2.1))
par(xpd=TRUE)
bp <- graph_compar(RATIOPENS   ,110,159,"Ratio pension/PIB")
title("Graphe 2 : Evolution du ratio retraite/PIB \nVariantes de scénario de croissance")
legend.text <- c("Scenario B","Scenario A","Scenario C")
legend(0, 0, legend.text,fill=c("grey0","grey40","grey80"))
legend.text <- c("ScenarioB","ScenarioA","ScenarioC")
legend(0, 0, legend.text,fill=c("grey0","grey40","grey80"))
legend.text
? legend
? plot
? legend
bp <- graph_compar(RATIOPENS   ,110,159,"Ratio pension/PIB")
title("Graphe 2 : Evolution du ratio retraite/PIB \nVariantes de scénario de croissance")
legend(0, 0, legend.text,fill=c("grey0","grey40","grey80"))
legend(2, 2, legend.text,fill=c("grey0","grey40","grey80"))
legend(mean(range(bp)), -0.5, legend.text,fill=c("grey0","grey40","grey80"))
egend(mean(range(bp),na.rm=TRUE), -0.5, legend.text,fill=c("grey0","grey40","grey80"))
legend(mean(range(bp),na.rm=TRUE), -0.5, legend.text,fill=c("grey0","grey40","grey80"))
legend("a")
legend(0,0,"a")
graph_compar(RATIOPENS   ,110,159,"Ratio pension/PIB")
title("Graphe 2 : Evolution du ratio retraite/PIB \nVariantes de scénario de croissance")
legend(1, -0.5, legend.text,fill=c("grey0","grey40","grey80"))
par(mar=c(7.1, 3.1, 4.1, 2.1))
par(xpd=TRUE)
graph_compar(RATIOPENS   ,110,159,"Ratio pension/PIB")
title("Graphe 2 : Evolution du ratio retraite/PIB \nVariantes de scénario de croissance")
legend(1, -0.5, legend.text,fill=c("grey0","grey40","grey80"))
? legend
legend(1, legend.text,fill=c("grey0","grey40","grey80"))
legend(1, legend.text,fill=c("grey0","grey40","grey80"))
legend(1, legend.text,fill=c("grey0","grey40","grey80"))
par(mar=c(3.1, 3.1, 4.1, 2.1))
par(xpd=TRUE)
graph_compar(RATIOPENS   ,110,159,"Ratio pension/PIB")
title("Graphe 2 : Evolution du ratio retraite/PIB \nVariantes de scénario de croissance")
legend(1, legend.text,fill=c("grey0","grey40","grey80"))
legend("topleft", legend.text,fill=c("grey0","grey40","grey80"))
legend("topleft",cex=0.9, legend.text,fill=c("grey0","grey40","grey80"))
par(mar=c(3.1, 3.1, 4.1, 2.1))
par(xpd=TRUE)
graph_compar(RATIOPENS   ,110,159,"Ratio pension/PIB")
title("Graphe 2 : Evolution du ratio retraite/PIB \nVariantes de scénario de croissance")
legend("topleft",cex=0.9, legend.text,fill=c("grey0","grey40","grey80"))
legend.text
par(mar=c(3.1, 3.1, 4.1, 2.1))
par(xpd=TRUE)
graph_compar(RATIOPENS   ,110,159,"Ratio pension/PIB")
title("Graphe 2 : Evolution du ratio retraite/PIB \nVariantes de scénario de croissance")
legend.text<-c("Scenario B" ,"Scenario A" ,"Scenario C")
legend("topleft",cex=0.9, legend.text,fill=c("grey0","grey40","grey80"))
save.image(paste0(cheminsource,"Simulations/CN/Scenario de reference/EffetReformes.RData"))
cheminsource <- "/Users/simonrabate/Desktop/PENSIPP 0.1/"
save.image(paste0(cheminsource,"Simulations/CN/Scenario de reference/EffetReformes.RData"))
plot   (seq(2010,2059,by=1),RATIOPENS[1,110:159],xlab="Annee", ylab="ratio retraite/PIB", ylab=titre,ylim=c(min(RATIOPENS[,110:159],na.rm=TRUE),max(RATIOPENS[,110:159],na.rm=TRUE)),col="grey80",lwd=4,type="lty")
points (seq(2010,2059,by=1),RATIOPENS[2,110:159],lwd=4,col="grey80",type="l")
points (seq(2010,2059,by=1),RATIOPENS[3,110:159],lwd=4,col="grey40",type="l")
points (seq(2010,2059,by=1),RATIOPENS[4,110:159],lwd=4,col="grey0",type="l")
title("Graphe 1 : Evolution du ratio retraites/PIB \nEffet des réformes")
legend.text <- c("Legislation 1992","Legislation 1993","Legislation 2003","Legislation 2012")
plot   (seq(2010,2059,by=1),RATIOPENS[1,110:159],xlab="Annee", ylab="ratio retraite/PIB",ylim=c(min(RATIOPENS[,110:159],na.rm=TRUE),max(RATIOPENS[,110:159],na.rm=TRUE)),col="grey80",lwd=4,type="lty")
points (seq(2010,2059,by=1),RATIOPENS[2,110:159],lwd=4,col="grey80",type="l")
points (seq(2010,2059,by=1),RATIOPENS[3,110:159],lwd=4,col="grey40",type="l")
points (seq(2010,2059,by=1),RATIOPENS[4,110:159],lwd=4,col="grey0",type="l")
title("Graphe 1 : Evolution du ratio retraites/PIB \nEffet des réformes")
legend.text <- c("Legislation 1992","Legislation 1993","Legislation 2003","Legislation 2012")
RATIOPENS
##########################  Analyses des masses des Avantages non contributifs ########
### 2e type d'ordre: minima de pensions neutralisés en premier
# Années de référence: 2020
# CdC : DF: 6,4 Md€, 6 Md€ et 4,2 Md€338  OK dans ANCIEN REGIME
#[1] 90087093492 85766845923 81882572796 81842203794
# 3993
# Chargement des données
cheminsource <- "/Users/simonrabate/Desktop/PENSIPP 0.1/"
load( (paste0(cheminsource,"Simulations/CN/Dispositifs NC/ANC_CN2.RData")))
load( (paste0(cheminsource,"Simulations/CN/Dispositifs NC/ANC_2.RData")))
graph_compar(PENREL      ,115,159,"Ratio pension/salaire")
graph_compar(PENREL_CN      ,115,159,"Ratio pension/salaire")
# MASSE TOTALE DES PENSIONS
# Masse totale des ANC
mtot   <- (MPENS[1,120]-MPENS[4,120])/1e9
mtot_cn<- (MPENS_CN[1,120]-MPENS_CN[4,120])/1e9
c(mtot,mtot_cn,mtot-mtot_cn)
# Masse des minima de pension
mtotMC   <-(MPENS[1,120]-MPENS[2,120])/1e9
mtotMC_cn<-(MPENS_CN[1,120]-MPENS_CN[2,120])/1e9
c(mtotMC,mtotMC_cn,mtotMC-mtotMC_cn)
# Masse des droits familiaux
mtotDF    <-(MPENS[2,120]-MPENS[3,120])/1e9   # Total DF
mtotDF_cn <-(MPENS_CN[2,120]-MPENS_CN[3,120])/1e9
c(mtotDF,mtotDF_cn,mtotDF-mtotDF_cn)
# Masse des Périodes assimilées chomage (PA)
mtotPA   <-(MPENS[3,120]-MPENS[4,120])/1e9
mtotPA_cn<-(MPENS_CN[3,120]-MPENS_CN[4,120])/1e9
c(mtotPA,mtotPA_cn,mtotPA-mtotPA_cn)
#Graphique
REF=c(mtotDF,mtotPA,mtotMC)
CN=c(mtotDF_cn,mtotPA_cn,mtotMC_cn)
barplot(cbind(REF,CN),col=c("grey0","grey40","grey80"),legend = c("Droits familiaux","Périodes assimilées","Minima de pension"))
title("Graphe 7: \nMasse des avantages contributif (2020, en Mds)")
# II.  PENSIONS A LIQUIDATION
# Masse totale des ANC
mtotliq   <- (MPENLIQ[1,120]-MPENLIQ[4,120])/1e9
mtotliq_cn<- (MPENLIQ_CN[1,120]-MPENLIQ_CN[4,120])/1e9
c(mtotliq,mtotliq_cn,mtotliq-mtotliq_cn)
# Masse des minima de pension
mtotliqMC   <-(MPENLIQ[1,120]-MPENLIQ[2,120])/1e9
mtotliqMC_cn<-(MPENLIQ_CN[1,120]-MPENLIQ_CN[2,120])/1e9
c(mtotliqMC,mtotliqMC_cn,mtotliqMC-mtotliqMC_cn)
# Masse des droits familiaux
mtotliqDF    <-(MPENLIQ[2,120]-MPENLIQ[3,120])/1e9   # Total DF
mtotliqDF_cn <-(MPENLIQ_CN[2,120]-MPENLIQ_CN[3,120])/1e9
c(mtotliqDF,mtotliqDF_cn,mtotliqDF-mtotliqDF_cn)
# Masse des Périodes assimilées chomage (PA)
mtotliqPA   <-(MPENLIQ[3,120]-MPENLIQ[4,120])/1e9
mtotliqPA_cn<-(MPENLIQ_CN[3,120]-MPENLIQ_CN[4,120])/1e9
c(mtotliqPA,mtotliqPA_cn,mtotliqPA-mtotliqPA_cn)
#Graphique
#REF=c(mtotDF,mtotPA,mtotMC)
#CN=c(mtotDF_cn,mtotPA_cn,mtotMC_cn)
REF=c(mtotliqDF,mtotliqPA,mtotliqMC)*5
CN=c(mtotliqDF_cn,mtotliqPA_cn,mtotliqMC_cn)*5
par("mar")
#par(mar=c(5.1, 4.1, 4.1, 2.1))
par(mar=c(6.1, 3.1, 4.1, 2.1))
par(xpd=TRUE)
bp <- barplot(cbind(REF,CN),col=c("grey0","grey40","grey80"))
box()
title("Graphe 7 : \nMasse des avantages contributifs (2020, en Mds)")
legend.text <- c("Droits familiaux","Périodes assimilées","Minima de pension")
legend(mean(range(bp)), -0.5, legend.text,cex=0.9, xjust = 0.5,yjust=1.3,fill=c("grey0","grey40","grey80"))
load( (paste0(cheminsource,"Simulations/CN/Dispositifs NC/ANC_CN2.RData")))
fix(PointsCN)
load( (paste0(cheminsource,"Simulations/CN/Dispositifs NC/ANC_CN2b.RData")))
load( (paste0(cheminsource,"Simulations/CN/Dispositifs NC/ANC_2.RData")))
graph_compar(PENREL      ,115,159,"Ratio pension/salaire")
graph_compar(PENREL_CN      ,115,159,"Ratio pension/salaire")
# MASSE TOTALE DES PENSIONS
# Masse totale des ANC
mtot   <- (MPENS[1,120]-MPENS[4,120])/1e9
mtot_cn<- (MPENS_CN[1,120]-MPENS_CN[4,120])/1e9
c(mtot,mtot_cn,mtot-mtot_cn)
# Masse des minima de pension
mtotMC   <-(MPENS[1,120]-MPENS[2,120])/1e9
mtotMC_cn<-(MPENS_CN[1,120]-MPENS_CN[2,120])/1e9
c(mtotMC,mtotMC_cn,mtotMC-mtotMC_cn)
# Masse des droits familiaux
mtotDF    <-(MPENS[2,120]-MPENS[3,120])/1e9   # Total DF
mtotDF_cn <-(MPENS_CN[2,120]-MPENS_CN[3,120])/1e9
c(mtotDF,mtotDF_cn,mtotDF-mtotDF_cn)
# Masse des Périodes assimilées chomage (PA)
mtotPA   <-(MPENS[3,120]-MPENS[4,120])/1e9
mtotPA_cn<-(MPENS_CN[3,120]-MPENS_CN[4,120])/1e9
c(mtotPA,mtotPA_cn,mtotPA-mtotPA_cn)
#Graphique
REF=c(mtotDF,mtotPA,mtotMC)
CN=c(mtotDF_cn,mtotPA_cn,mtotMC_cn)
barplot(cbind(REF,CN),col=c("grey0","grey40","grey80"),legend = c("Droits familiaux","Périodes assimilées","Minima de pension"))
title("Graphe 7: \nMasse des avantages contributif (2020, en Mds)")
# II.  PENSIONS A LIQUIDATION
# Masse totale des ANC
mtotliq   <- (MPENLIQ[1,120]-MPENLIQ[4,120])/1e9
mtotliq_cn<- (MPENLIQ_CN[1,120]-MPENLIQ_CN[4,120])/1e9
c(mtotliq,mtotliq_cn,mtotliq-mtotliq_cn)
# Masse des minima de pension
mtotliqMC   <-(MPENLIQ[1,120]-MPENLIQ[2,120])/1e9
mtotliqMC_cn<-(MPENLIQ_CN[1,120]-MPENLIQ_CN[2,120])/1e9
c(mtotliqMC,mtotliqMC_cn,mtotliqMC-mtotliqMC_cn)
# Masse des droits familiaux
mtotliqDF    <-(MPENLIQ[2,120]-MPENLIQ[3,120])/1e9   # Total DF
mtotliqDF_cn <-(MPENLIQ_CN[2,120]-MPENLIQ_CN[3,120])/1e9
c(mtotliqDF,mtotliqDF_cn,mtotliqDF-mtotliqDF_cn)
# Masse des Périodes assimilées chomage (PA)
mtotliqPA   <-(MPENLIQ[3,120]-MPENLIQ[4,120])/1e9
mtotliqPA_cn<-(MPENLIQ_CN[3,120]-MPENLIQ_CN[4,120])/1e9
c(mtotliqPA,mtotliqPA_cn,mtotliqPA-mtotliqPA_cn)
#Graphique
#REF=c(mtotDF,mtotPA,mtotMC)
#CN=c(mtotDF_cn,mtotPA_cn,mtotMC_cn)
REF=c(mtotliqDF,mtotliqPA,mtotliqMC)*5
CN=c(mtotliqDF_cn,mtotliqPA_cn,mtotliqMC_cn)*5
par("mar")
#par(mar=c(5.1, 4.1, 4.1, 2.1))
par(mar=c(6.1, 3.1, 4.1, 2.1))
par(xpd=TRUE)
bp <- barplot(cbind(REF,CN),col=c("grey0","grey40","grey80"))
box()
title("Graphe 7 : \nMasse des avantages contributifs (2020, en Mds)")
legend.text <- c("Droits familiaux","Périodes assimilées","Minima de pension")
legend(mean(range(bp)), -0.5, legend.text,cex=0.9, xjust = 0.5,yjust=1.3,fill=c("grey0","grey40","grey80"))
bp <- barplot(cbind(REF,CN),col=c("grey0","grey40","grey80"), ylim=c(0,3))
par(mar=c(6.1, 3.1, 4.1, 2.1))
par(xpd=TRUE)
bp <- barplot(cbind(REF,CN),col=c("grey0","grey40","grey80"), ylim=c(0,3))
box()
title("Graphe 7 : Masse des avantages contributifs (\nFlux de liquidants 2020, en milliards)")
legend.text <- c("Droits familiaux","Périodes assimilées","Minima de pension")
legend(mean(range(bp)), -0.5, legend.text,cex=0.9, xjust = 0.5,yjust=1.3,fill=c("grey0","grey40","grey80"))
par(mar=c(5.1, 3.1, 4.1, 2.1))
par(xpd=TRUE)
bp <- barplot(cbind(REF,CN),col=c("grey0","grey40","grey80"), ylim=c(0,3))
box()
title("Graphe 7 : Masse des avantages contributifs (\nFlux de liquidants 2020, en milliards)")
legend.text <- c("Droits familiaux","Périodes assimilées","Minima de pension")
legend(mean(range(bp)), -0.5, legend.text,cex=0.9, xjust = 0.5,yjust=1.3,fill=c("grey0","grey40","grey80"))
legend(mean(range(bp)), -0.5, legend.text,cex=0.9, xjust = 0.5,yjust=1,fill=c("grey0","grey40","grey80"))
par(mar=c(5.1, 3.1, 4.1, 2.1))
par(xpd=TRUE)
bp <- barplot(cbind(REF,CN),col=c("grey0","grey40","grey80"), ylim=c(0,3))
box()
title("Graphe 7 : Masse des avantages contributifs \n(Flux de liquidants 2020, en milliards)")
legend.text <- c("Droits familiaux","Périodes assimilées","Minima de pension")
legend(mean(range(bp)), -0.5, legend.text,cex=0.9, xjust = 0.5,yjust=1,fill=c("grey0","grey40","grey80"))
############# Effet des réformes  #############
#Effet des réformes successives dans le régime actuel.
#But: retrouver résultats du COR et de DB dans la note IPP.
t0  <- Sys.time()
#### Chargement des programmes source ####
rm(list = ls())
# Déclaration du chemin pour les fichiers sources
cheminsource <- "/Users/simonrabate/Desktop/PENSIPP 0.1/"
source( (paste0(cheminsource,"Modele/Outils/OutilsRetraite/OutilsMS.R"           )) )
source( (paste0(cheminsource,"Modele/Outils/OutilsRetraite/OutilsPensIPP.R"      )) )
source( (paste0(cheminsource,"Modele/Outils/OutilsRetraite/OutilsLeg.R"          )) )
source( (paste0(cheminsource,"Modele/Outils/OutilsRetraite/OutilsRetr.R"         )) )
source( (paste0(cheminsource,"Modele/Outils/OutilsRetraite/OutilsCN.R"           )) )
# Declaration des variable d'outputs
TRC         <- numeric(taille_max)        # Taux de remplacemnt cible des liquidants
pensionliq  <- numeric(taille_max)        # Pension à la liquidation
actifs      <- numeric(taille_max)        # Filtre population active
retraites   <- numeric(taille_max)        # Filtre population retraitée
MSAL        <- matrix(nrow=4,ncol=200)    # Masse salariale par année
MPENS       <- matrix(nrow=4,ncol=200)    # Masse des pensions année
PIBREF      <- matrix(nrow=4,ncol=200)    # PIB annuel
RATIOPENS   <- matrix(nrow=4,ncol=200)    # Ratio pension/PIB par année
RATIOFIN    <- matrix(nrow=4,ncol=200)    # Ratio masse des pensions/masse des salaires par année
RATIODEM    <- matrix(nrow=4,ncol=200)    # Ratio +60ans/-60ans par année
SALMOY      <- matrix(nrow=4,ncol=200)    # Salaire moyen par année
DSALMOY     <- matrix(nrow=4,ncol=200)    # Croissance du salaire moyen
PENMOY      <- matrix(nrow=4,ncol=200)    # Pension moyenne par année
PENLIQMOY   <- matrix(nrow=4,ncol=200)    # Pension moyenne des liquidants par année
PENREL      <- matrix(nrow=4,ncol=200)    # Ratio pension/salaire
TRCMOY      <- matrix(nrow=4,ncol=200)    # Taux de remplacement cible des liquidants par année
AGELIQ      <- matrix(nrow=4,ncol=160)    # Age de liquidation moyen par année
AGELIQH     <- matrix(nrow=4,ncol=160)    # Age de liquidation moyen homme par année
AGELIQF     <- matrix(nrow=4,ncol=160)    # Age de liquidation moyen femme par année
AGELIQgen   <- matrix(nrow=4,ncol=160)    # Age de liquidation moyen par génération
AGELIQgenH  <- matrix(nrow=4,ncol=160)    # Age de liquidation moyen homme par génération
AGELIQgenF  <- matrix(nrow=4,ncol=160)    # Age de liquidation moyen femme par génération
W           <- 2047.501
cibletaux<-numeric(taille_max)
#### Début de la simulation ####
#  Rprof(tmp<-tempfile())
for (sc in c(1,2,3,4))
{
# Reinitialisation variables
source( (paste0(cheminsource,"Modele/Outils/OutilsRetraite/DefVarRetr_Destinie.R")) )
load  ( (paste0(cheminsource,"Modele/Outils/OutilsBio/BiosDestinie2.RData"        )) )
for (t in 60:160)   # Début de la boucle temporelle, commence en 60,
#individu le plus vieux de la base n? en 1909.
{
print (c(sc,t))
if (sc==1)      {Leg <- min(92,t)}
else if (sc==2) {Leg <- min(93,t)}
else if (sc==3) {Leg <- min(103,t)}
else            {Leg <- t}
for (i in 1:55000)   # Début de la boucle individuelle
{
if ((t-t_naiss[i]>=55) && (ageliq[i]==0))
{
UseLeg(Leg,t_naiss[i])
SimDir(i,t,"tp")
if (t_liq[i]==t)
{
pensionliq[i] <- pension[i]
}
}
else if (ageliq[i]>0)
{
Revalo(i,t,t+1)
}
} # Fin de la boucle individuelle
actifs    <- (salaire[,t]>0) & (statut[,t]>0)
retraites <- (pension>0) & (statut[,t]>0)
SALMOY[sc,t]       <- mean (salaire[actifs,t]/Prix[t])
MPENS[sc,t]        <- W*sum(pension[retraites])/Prix[t]
MSAL[sc,t]         <- W*sum(salaire[actifs,t])/Prix[t]
PIBREF[sc,t]       <- MSAL[sc,t]*(PIB[109]/Prix[109])/MSAL[sc,109]
RATIOPENS[sc,t]    <- MPENS[sc,t]/PIBREF[sc,t]
TRCMOY[sc,t]       <- mean (TRC[which(t_liq[]==t)])
RATIOFIN[sc,t]     <- MPENS[sc,t]/MSAL[sc,t]
RATIODEM[sc,t]     <- sum  ((t-t_naiss>=60) & (statut[,t]>0))/sum((t-t_naiss<60) &(statut[,t]>0))
if (t>=110)
{
DSALMOY[sc,t]      <- SALMOY[sc,t]/SALMOY[sc,t-1]-1}
PENMOY[sc,t]       <- mean (pension[retraites]/Prix[t])
PENLIQMOY[sc,t]    <- mean (pension[which( (pension>0)&t_liq==t)])
PENREL[sc,t]       <- PENMOY[sc,t]/SALMOY[sc,t]
AGELIQ[sc,t]       <- mean ( ageliq[which(t_liq==t)])
AGELIQH[sc,t]      <- mean ( ageliq[which((t_liq==t)  & (sexe==1))] )
AGELIQF[sc,t]      <- mean ( ageliq[which((t_liq==t) & (sexe==2))])
} # Fin de de la boucle temporelle
# Récapitulatifs par générations
for (g in 20:80)
{
AGELIQgen[sc,g]      <- mean ( ageliq[which((t_naiss==g) & (ageliq>0))])
AGELIQgenH[sc,g]     <- mean ( ageliq[which((t_naiss==g) & (ageliq>0)& (sexe==1))])
AGELIQgenF[sc,g]     <- mean ( ageliq[which((t_naiss==g) & (ageliq>0)& (sexe==2))])
}
} # Fin boucle scenarios
#### Sorties ####
# Sauvegarde du workspace et du graphique
save.image(paste0(cheminsource,"Simulations/CN/Scenario de reference/EffetReformes.RData"))
plot   (seq(2010,2059,by=1),RATIOPENS[1,110:159],xlab="Annee", ylab="ratio retraite/PIB",ylim=c(min(RATIOPENS[,110:159],na.rm=TRUE),max(RATIOPENS[,110:159],na.rm=TRUE)),col="grey80",lwd=4,type="lty")
points (seq(2010,2059,by=1),RATIOPENS[2,110:159],lwd=4,col="grey80",type="l")
points (seq(2010,2059,by=1),RATIOPENS[3,110:159],lwd=4,col="grey40",type="l")
points (seq(2010,2059,by=1),RATIOPENS[4,110:159],lwd=4,col="grey0",type="l")
title("Graphe 1 : Evolution du ratio retraites/PIB \nEffet des réformes")
legend.text <- c("Legislation 1992","Legislation 1993","Legislation 2003","Legislation 2012")
plot   (seq(2010,2059,by=1),RATIOPENS[1,110:159],xlab="Annee", ylab="ratio retraite/PIB",ylim=c(min(RATIOPENS[,110:159],na.rm=TRUE),max(RATIOPENS[,110:159],na.rm=TRUE)),col="grey100",lwd=4,type="lty")
points (seq(2010,2059,by=1),RATIOPENS[2,110:159],lwd=4,col="grey80",type="l")
points (seq(2010,2059,by=1),RATIOPENS[3,110:159],lwd=4,col="grey40",type="l")
points (seq(2010,2059,by=1),RATIOPENS[4,110:159],lwd=4,col="grey0",type="l")
plot   (seq(2010,2059,by=1),RATIOPENS[1,110:159],xlab="Annee", ylab="ratio retraite/PIB",ylim=c(min(RATIOPENS[,110:159],na.rm=TRUE),max(RATIOPENS[,110:159],na.rm=TRUE)),col="grey90",lwd=4,type="lty")
points (seq(2010,2059,by=1),RATIOPENS[2,110:159],lwd=4,col="grey80",type="l")
points (seq(2010,2059,by=1),RATIOPENS[3,110:159],lwd=4,col="grey40",type="l")
points (seq(2010,2059,by=1),RATIOPENS[4,110:159],lwd=4,col="grey0",type="l")
plot   (seq(2010,2059,by=1),RATIOPENS[1,110:159],xlab="Annee", ylab="ratio retraite/PIB",ylim=c(min(RATIOPENS[,110:159],na.rm=TRUE),max(RATIOPENS[,110:159],na.rm=TRUE)),col="grey90",lwd=4,type="l")
points (seq(2010,2059,by=1),RATIOPENS[2,110:159],lwd=4,col="grey80",type="l")
points (seq(2010,2059,by=1),RATIOPENS[3,110:159],lwd=4,col="grey40",type="l")
points (seq(2010,2059,by=1),RATIOPENS[4,110:159],lwd=4,col="grey0",type="l")
title("Graphe 1 : Evolution du ratio retraites/PIB \nEffet des réformes")
legend(2.8,-1,legend.text, fill=c("grey0","grey40","grey80","grey90"))
legend("bottomcenter",inset=c(-0.2,0),legend.text, fill=c("grey0","grey40","grey80","grey90"))
legend("bottom",inset=c(-0.2,0),legend.text, fill=c("grey0","grey40","grey80","grey90"))
legend("bottom",inset=c(-2,0),legend.text, fill=c("grey0","grey40","grey80","grey90"))
legend("bottom",inset=c(-2,-2),legend.text, fill=c("grey0","grey40","grey80","grey90"))
legend("topright",inset=c(-2,0),legend.text, fill=c("grey0","grey40","grey80","grey90"))
plot   (seq(2010,2059,by=1),RATIOPENS[1,110:159],xlab="Annee", ylab="ratio retraite/PIB",ylim=c(min(RATIOPENS[,110:159],na.rm=TRUE),max(RATIOPENS[,110:159],na.rm=TRUE)),col="grey90",lwd=4,type="l")
points (seq(2010,2059,by=1),RATIOPENS[2,110:159],lwd=4,col="grey80",type="l")
points (seq(2010,2059,by=1),RATIOPENS[3,110:159],lwd=4,col="grey40",type="l")
points (seq(2010,2059,by=1),RATIOPENS[4,110:159],lwd=4,col="grey0",type="l")
title("Graphe 1 : Evolution du ratio retraites/PIB \nEffet des réformes")
par(xpd=TRUE)
legend.text <- c("Legislation 1992","Legislation 1993","Legislation 2003","Legislation 2012")
legend("topright",inset=c(-2,0),legend.text, fill=c("grey0","grey40","grey80","grey90"))
legend("topright",inset=c(-2,0),legend.text, fill=c("grey0","grey40","grey80","grey90"))
legend("topright",inset=c(-0.2,0),legend.text, fill=c("grey0","grey40","grey80","grey90"))
par(mar=c(6.1, 3.1, 4.1, 2.1))
par(xpd=TRUE)
plot   (seq(2010,2059,by=1),RATIOPENS[1,110:159],xlab="Annee", ylab="ratio retraite/PIB",ylim=c(min(RATIOPENS[,110:159],na.rm=TRUE),max(RATIOPENS[,110:159],na.rm=TRUE)),col="grey90",lwd=4,type="l")
points (seq(2010,2059,by=1),RATIOPENS[2,110:159],lwd=4,col="grey80",type="l")
points (seq(2010,2059,by=1),RATIOPENS[3,110:159],lwd=4,col="grey40",type="l")
points (seq(2010,2059,by=1),RATIOPENS[4,110:159],lwd=4,col="grey0",type="l")
title("Graphe 1 : Evolution du ratio retraites/PIB \nEffet des réformes")
legend.text <- c("Legislation 1992","Legislation 1993","Legislation 2003","Legislation 2012")
legend("topright",inset=c(-0.2,0),cex=0.9,legend.text, fill=c("grey0","grey40","grey80","grey90"))
par(mar=c(2.1, 3.1, 4.1, 4.1))
par(xpd=TRUE)
plot   (seq(2010,2059,by=1),RATIOPENS[1,110:159],xlab="Annee", ylab="ratio retraite/PIB",ylim=c(min(RATIOPENS[,110:159],na.rm=TRUE),max(RATIOPENS[,110:159],na.rm=TRUE)),col="grey90",lwd=4,type="l")
points (seq(2010,2059,by=1),RATIOPENS[2,110:159],lwd=4,col="grey80",type="l")
points (seq(2010,2059,by=1),RATIOPENS[3,110:159],lwd=4,col="grey40",type="l")
points (seq(2010,2059,by=1),RATIOPENS[4,110:159],lwd=4,col="grey0",type="l")
title("Graphe 1 : Evolution du ratio retraites/PIB \nEffet des réformes")
legend.text <- c("Legislation 1992","Legislation 1993","Legislation 2003","Legislation 2012")
legend("topright",inset=c(-0.2,0),cex=0.9,legend.text, fill=c("grey0","grey40","grey80","grey90"))
par(mar=c(5.1, 3.1, 4.1, 2.1))
par(xpd=TRUE)
plot   (seq(2010,2059,by=1),RATIOPENS[1,110:159],xlab="Annee", ylab="ratio retraite/PIB",ylim=c(min(RATIOPENS[,110:159],na.rm=TRUE),max(RATIOPENS[,110:159],na.rm=TRUE)),col="grey90",lwd=4,type="l")
points (seq(2010,2059,by=1),RATIOPENS[2,110:159],lwd=4,col="grey80",type="l")
points (seq(2010,2059,by=1),RATIOPENS[3,110:159],lwd=4,col="grey40",type="l")
points (seq(2010,2059,by=1),RATIOPENS[4,110:159],lwd=4,col="grey0",type="l")
title("Graphe 1 : Evolution du ratio retraites/PIB \nEffet des réformes")
legend.text <- c("Legislation 1992","Legislation 1993","Legislation 2003","Legislation 2012")
legend("bottom",inset=c(-0.2,-0.2),cex=0.9,legend.text, fill=c("grey0","grey40","grey80","grey90"))
par(mar=c(6.1, 3.1, 4.1, 2.1))
par(xpd=TRUE)
plot   (seq(2010,2059,by=1),RATIOPENS[1,110:159],xlab="Annee", ylab="ratio retraite/PIB",ylim=c(min(RATIOPENS[,110:159],na.rm=TRUE),max(RATIOPENS[,110:159],na.rm=TRUE)),col="grey90",lwd=4,type="l")
points (seq(2010,2059,by=1),RATIOPENS[2,110:159],lwd=4,col="grey80",type="l")
points (seq(2010,2059,by=1),RATIOPENS[3,110:159],lwd=4,col="grey40",type="l")
points (seq(2010,2059,by=1),RATIOPENS[4,110:159],lwd=4,col="grey0",type="l")
title("Graphe 1 : Evolution du ratio retraites/PIB \nEffet des réformes")
legend.text1 <- c("Legislation 1992","Legislation 1993")
legend.text2 <- c("Legislation 2003","Legislation 2012")
legend("bottom",inset=c(-0.5,-0.5),cex=0.9,legend.text1, fill=c("grey0","grey40"))
legend("bottom",inset=c(0.5,-0.5),cex=0.9,legend.text2, fill=c("grey80","grey90"))
legend("bottom",inset=c(-1,-0.5),cex=0.9,legend.text1, fill=c("grey0","grey40"))
legend("bottom",inset=c(-1,-1),cex=0.9,legend.text1, fill=c("grey0","grey40"))
legend("bottomleft",inset=c(-1,-1),cex=0.9,legend.text1, fill=c("grey0","grey40"))
legend("bottomright",inset=c(0.5,-0.5),cex=0.9,legend.text2, fill=c("grey80","grey90"))
legend("bottomleft",inset=c(-0.5,-1),cex=0.9,legend.text1, fill=c("grey0","grey40"))
legend("bottomright",inset=c(-0.5,-0.5),cex=0.9,legend.text2, fill=c("grey80","grey90"))
legend("bottomleft",inset=c(-0.5,-1),cex=0.9,legend.text1, fill=c("grey0","grey40"))
legend("bottomright",inset=c(-0.5,-1),cex=0.9,legend.text2, fill=c("grey80","grey90"))
legend("bottomleft",inset=c(-5,-1),cex=0.9,legend.text1, fill=c("grey0","grey40"))
legend("bottomleft",inset=c(-0.5,-1),cex=0.8,legend.text1, fill=c("grey0","grey40"))
legend("bottomright",inset=c(-0.5,-1),cex=0.8,legend.text2, fill=c("grey80","grey90"))
par(mar=c(6.1, 3.1, 4.1, 2.1))
par(xpd=TRUE)
plot   (seq(2010,2059,by=1),RATIOPENS[1,110:159],xlab="Annee", ylab="ratio retraite/PIB",ylim=c(min(RATIOPENS[,110:159],na.rm=TRUE),max(RATIOPENS[,110:159],na.rm=TRUE)),col="grey90",lwd=4,type="l")
points (seq(2010,2059,by=1),RATIOPENS[2,110:159],lwd=4,col="grey80",type="l")
points (seq(2010,2059,by=1),RATIOPENS[3,110:159],lwd=4,col="grey40",type="l")
points (seq(2010,2059,by=1),RATIOPENS[4,110:159],lwd=4,col="grey0",type="l")
title("Graphe 1 : Evolution du ratio retraites/PIB \nEffet des réformes")
legend.text1 <- c("Legislation 1992","Legislation 1993")
legend.text2 <- c("Legislation 2003","Legislation 2012")
legend("bottomleft",inset=c(-0.5,-1),cex=0.8,legend.text1, fill=c("grey0","grey40"))
legend("bottomright",inset=c(-0.5,-1),cex=0.8,legend.text2, fill=c("grey80","grey90"))
legend("bottomleft",inset=c(0.5,-1),cex=0.8,legend.text1, fill=c("grey0","grey40"))
legend("bottomright",inset=c(0.5,-1),cex=0.8,legend.text2, fill=c("grey80","grey90"))
legend("bottom",inset=c(0.5,-1),cex=0.8,legend.text2, fill=c("grey80","grey90"))
legend("bottom",inset=c(0.5,-1),cex=0.8,legend.text1, fill=c("grey0","grey40"))
legend("bottom",inset=c(-0.2,-0.2),cex=0.9,legend.text, fill=c("grey0","grey40","grey80","grey90"))
legend("bottom",inset=c(-0.2,-0.5),cex=0.9,legend.text, fill=c("grey0","grey40","grey80","grey90"))
legend("bottom",inset=c(-0.2,-0.7),cex=0.9,legend.text, fill=c("grey0","grey40","grey80","grey90"))
legend("bottom",inset=c(-0.2,-0.6),cex=0.9,legend.text, fill=c("grey0","grey40","grey80","grey90"))
plot   (seq(2010,2059,by=1),RATIOPENS[1,110:159],xlab="Annee", ylab="ratio retraite/PIB",ylim=c(min(RATIOPENS[,110:159],na.rm=TRUE),max(RATIOPENS[,110:159],na.rm=TRUE)),col="grey90",lwd=4,type="l")
points (seq(2010,2059,by=1),RATIOPENS[2,110:159],lwd=4,col="grey80",type="l")
points (seq(2010,2059,by=1),RATIOPENS[3,110:159],lwd=4,col="grey40",type="l")
points (seq(2010,2059,by=1),RATIOPENS[4,110:159],lwd=4,col="grey0",type="l")
title("Graphe 1 : Evolution du ratio retraites/PIB \nEffet des réformes")
legend.text1 <- c("Legislation 1992","Legislation 1993")
legend.text2 <- c("Legislation 2003","Legislation 2012")
legend("bottom",inset=c(-0.2,-0.6),cex=0.9,legend.text, fill=c("grey0","grey40","grey80","grey90"))
par(mar=c(6.1, 3.1, 4.1, 2.1))
par(xpd=TRUE)
plot   (seq(2010,2059,by=1),RATIOPENS[1,110:159],xlab="Annee", ylab="ratio retraite/PIB",ylim=c(min(RATIOPENS[,110:159],na.rm=TRUE),max(RATIOPENS[,110:159],na.rm=TRUE)),col="grey90",lwd=4,type="l")
points (seq(2010,2059,by=1),RATIOPENS[2,110:159],lwd=4,col="grey80",type="l")
points (seq(2010,2059,by=1),RATIOPENS[3,110:159],lwd=4,col="grey40",type="l")
points (seq(2010,2059,by=1),RATIOPENS[4,110:159],lwd=4,col="grey0",type="l")
title("Graphe 1 : Evolution du ratio retraites/PIB \nEffet des réformes")
legend.text <- c("Legislation 2012","Legislation 2003","Legislation 1993","Legislation 1992")
legend("bottom",inset=c(-0.2,-0.6),cex=0.9,legend.text, fill=c("grey0","grey40","grey80","grey90"))
